@base <https://example.org/indices/> .
@prefix idx: <https://w3id.org/solid-crdt-sync/vocab/idx#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix schema: <https://schema.org/> .
@prefix : <#> .

# Complex template with multiple properties, transforms, missingValue, different hierarchy levels
:it a idx:GroupIndexTemplate ;
    idx:indexesClass schema:Task ;
    idx:shardingAlgorithm [
        a idx:ModuloHashSharding ;
        idx:hashAlgorithm "md5" ;
        idx:numberOfShards 1 ;
        idx:configVersion "1_0_0" ;
        idx:autoScaleThreshold 1000
    ] ;
    idx:groupedBy [
        a idx:GroupingRule ;
        idx:property [
            a idx:GroupingRuleProperty ;
            idx:sourceProperty schema:assignee ;
            idx:hierarchyLevel 1 ;
            idx:missingValue "unassigned"
        ] ;
        idx:property [
            a idx:GroupingRuleProperty ;
            idx:sourceProperty schema:dateCreated ;
            idx:hierarchyLevel 2 ;
            idx:transform (
                [
                    a idx:RegexTransform ;
                    idx:pattern "^([0-9]{4})-[0-9]{2}-[0-9]{2}$" ;
                    idx:replacement "${1}"
                ]
            )
        ] ;
        idx:property [
            a idx:GroupingRuleProperty ;
            idx:sourceProperty schema:status ;
            idx:hierarchyLevel 1
        ]
    ] .
