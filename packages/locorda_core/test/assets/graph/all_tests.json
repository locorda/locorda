{
  "version": "1.0",
  "base": {
    "timestamp": "2024-01-01T00:00:00Z",
    "installation_id": "test-installation"
  },
  "urlToPathMap": {
    "https://example.org/test/mappings/recipe-v1": "shared/mappings/recipe-v1.ttl",
    "https://w3id.org/solid-crdt-sync/mappings/core-v1": "../../../../../spec/mappings/core-v1.ttl",
    "https://w3id.org/solid-crdt-sync/mappings/client-installation-v1": "../../../../../spec/mappings/client-installation-v1.ttl"
  },
  "test_suites": [
    {
      "suite": "save",
      "description": "Tests for SyncGraphManager.save() operation",
      "tests": [
        {
          "id": "save_01",
          "title": "First save of new resource",
          "description": "Saving a new resource when no data exists in storage should add all triples with CRDT metadata",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "input_resource": "test_cases/save/01_first_save/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/01_first_save/expected_stored_graph.ttl",
            "installation": "test_cases/save/01_first_save/expected_installation.ttl"
          },
          "action_ts": {
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_02",
          "title": "Update existing resource - LWW property change",
          "description": "Updating a LWW-Register property (name) should increment clock and replace old value",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/02_update_lww/stored_graph_before.ttl",
          "input_resource": "test_cases/save/02_update_lww/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/02_update_lww/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/name",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_03",
          "title": "Update existing resource - OR-Set add elements",
          "description": "Adding elements to an OR-Set property (recipeIngredient) should preserve existing elements and add new ones",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/03_orset_add/stored_graph_before.ttl",
          "input_resource": "test_cases/save/03_orset_add/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/03_orset_add/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/recipeIngredient",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_04",
          "title": "Update existing resource - OR-Set remove element",
          "description": "Removing an element from an OR-Set property should generate tombstone metadata and remove the element",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/04_orset_remove/stored_graph_before.ttl",
          "input_resource": "test_cases/save/04_orset_remove/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/04_orset_remove/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/recipeIngredient",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_05",
          "title": "Update multiple properties simultaneously",
          "description": "Updating both LWW (name) and OR-Set (recipeIngredient) properties in single save should increment clock once and handle both CRDT types",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/05_multiple_properties/stored_graph_before.ttl",
          "input_resource": "test_cases/save/05_multiple_properties/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/05_multiple_properties/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/name",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/recipeIngredient",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_06",
          "title": "No-op save (identical data)",
          "description": "Saving identical data should detect no changes, skip save, and leave document unchanged",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/06_noop/stored_graph_before.ttl",
          "input_resource": "test_cases/save/06_noop/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/06_noop/expected_stored_graph.ttl",
            "property_changes": []
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_07",
          "title": "Nested resources with fragment identifiers",
          "description": "Saving a resource with nested fragment-identified resources should handle both resources and their properties correctly",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "input_resource": "test_cases/save/07_nested_fragments/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/07_nested_fragments/expected_stored_graph.ttl"
          },
          "action_ts": {
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_08",
          "title": "Update nested resource properties",
          "description": "Updating properties of a nested fragment-identified resource should track changes for the nested resource",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/08_update_nested/stored_graph_before.ttl",
          "input_resource": "test_cases/save/08_update_nested/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/08_update_nested/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#nutrition",
                "property_iri": "https://schema.org/calories",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#nutrition",
                "property_iri": "https://schema.org/fatContent",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_09",
          "title": "Remove nested resource entirely",
          "description": "Removing a nested fragment-identified resource should generate resource deletion tombstone",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/09_remove_nested/stored_graph_before.ttl",
          "input_resource": "test_cases/save/09_remove_nested/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/09_remove_nested/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/nutrition",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_10",
          "title": "Add new nested resource",
          "description": "Adding a new nested fragment-identified resource should track changes for both the parent and nested resource",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/10_add_nested/stored_graph_before.ttl",
          "input_resource": "test_cases/save/10_add_nested/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/10_add_nested/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/nutrition",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#nutrition",
                "property_iri": "http://www.w3.org/1999/02/22-rdf-syntax-ns#type",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#nutrition",
                "property_iri": "https://schema.org/calories",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#nutrition",
                "property_iri": "https://schema.org/fatContent",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_11",
          "title": "Foreign clock entries preserved on update",
          "description": "When updating a document with clock entries from other installations, those foreign clock entries should be preserved",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/11_foreign_clock_preserved/stored_graph_before.ttl",
          "input_resource": "test_cases/save/11_foreign_clock_preserved/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/11_foreign_clock_preserved/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/name",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_12",
          "title": "First save with identified blank nodes",
          "description": "Saving a resource with identified blank nodes should generate canonical fragment IRIs and create sync:hasBlankNodeMapping entries",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "input_resource": "test_cases/save/12_blank_node_first_save/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/12_blank_node_first_save/expected_stored_graph.ttl"
          },
          "action_ts": {
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_13",
          "title": "Update preserves identified blank node mappings",
          "description": "Updating a resource with existing identified blank node mappings should preserve those mappings and not create duplicates",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/13_blank_node_preserved/stored_graph_before.ttl",
          "input_resource": "test_cases/save/13_blank_node_preserved/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/13_blank_node_preserved/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/name",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_14",
          "title": "Update identified blank node properties",
          "description": "Changing properties of an identified blank node should track the change and preserve the canonical mapping",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/14_update_blank_node_property/stored_graph_before.ttl",
          "input_resource": "test_cases/save/14_update_blank_node_property/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/14_update_blank_node_property/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#lcrd-ibn-md5-74f4d0cc07fa8ce00b8856defa9a0e31",
                "property_iri": "https://schema.org/amount",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_15",
          "title": "Add new identified blank node to existing set",
          "description": "Adding a new identified blank node to an OR-Set should create a new mapping and track the property change",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/15_add_blank_node/stored_graph_before.ttl",
          "input_resource": "test_cases/save/15_add_blank_node/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/15_add_blank_node/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/recipeIngredient",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#lcrd-ibn-md5-9110880a000d224b944a75c68db15db9",
                "property_iri": "https://schema.org/amount",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#lcrd-ibn-md5-9110880a000d224b944a75c68db15db9",
                "property_iri": "https://schema.org/unit",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#lcrd-ibn-md5-9110880a000d224b944a75c68db15db9",
                "property_iri": "http://www.w3.org/1999/02/22-rdf-syntax-ns#type",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              },
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#lcrd-ibn-md5-9110880a000d224b944a75c68db15db9",
                "property_iri": "https://schema.org/name",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        },
        {
          "id": "save_16",
          "title": "Remove identified blank node from set",
          "description": "Removing an identified blank node from an OR-Set should generate a tombstone using the canonical IRI and preserve the mapping",
          "config": "shared/configs/basic_config.json",
          "typeIri": "https://schema.org/Recipe",
          "stored_graph_before": "test_cases/save/16_remove_blank_node/stored_graph_before.ttl",
          "input_resource": "test_cases/save/16_remove_blank_node/input_resource.ttl",
          "expected": {
            "stored_graph": "test_cases/save/16_remove_blank_node/expected_stored_graph.ttl",
            "property_changes": [
              {
                "resource_iri": "tag:locorda.org,2025:l:aHR0cHM6Ly9zY2hlbWEub3JnL1JlY2lwZQ==:cmVjaXBlMTIz#it",
                "property_iri": "https://schema.org/recipeIngredient",
                "changed_at": "2024-01-01T02:00:00Z",
                "logical_clock": 2
              }
            ]
          },
          "action_ts": {
            "prepare": {
              "save": "2024-01-01T00:00:00Z"
            },
            "save": "2024-01-01T02:00:00Z"
          }
        }
      ]
    }
  ]
}